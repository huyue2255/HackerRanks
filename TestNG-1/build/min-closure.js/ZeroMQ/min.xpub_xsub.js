'use strict';var zmq=require("zmq"),xsub=zmq.socket("xsub");xsub.bindSync("tcp://*:8700");var xpub=zmq.socket("xpub");xpub.setsockopt(zmq.ZMQ_XPUB_VERBOSE,1);xpub.bindSync("tcp://*:8701");xsub.on("message",function(b,a){xpub.send([b,a])});xpub.on("message",function(b){xsub.send(b)});for(var i=1;5>=i;i++)(function(b){var a=zmq.socket("sub");a.subscribe("Topic 1");a.on("message",function(a,d){console.log("Subscriber",b,"received",d.toString(),"on topic",a.toString())});a.connect("tcp://localhost:8701")})(i);
for(i=1;5>=i;i++)(function(b){var a=zmq.socket("pub");a.connect("tcp://localhost:8700");var c=1;setInterval(function(){a.send(["Topic 1","message "+c++ +" from publisher "+b])},500*b)})(i);