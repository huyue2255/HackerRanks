'use strict';var zmq=require(".."),should=require("should");
it("should cooperate with gc",function(b){var f=zmq.socket("dealer"),c=zmq.socket("dealer");f.on("message",function(a){a.should.be.an.instanceof(Buffer);a.toString().should.equal("hello");this.close();c.close();clearTimeout(g);b()});var d=!1;f.bind("tcp://127.0.0.1:5555",function(a){a?(clearInterval(e),b(a)):d=!0});var e=setInterval(function(){gc();d&&(clearInterval(e),c.connect("tcp://127.0.0.1:5555"),c.send("hello"))},100),g=setTimeout(function(){clearInterval(e);b(Error("timeout of 5000ms exceeded (bound: "+
d+")"))},15E3)});