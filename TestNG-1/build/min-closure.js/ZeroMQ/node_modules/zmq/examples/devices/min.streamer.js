'use strict';var zmq=require("../../"),frontPort="tcp://127.0.0.1:12345",backPort="tcp://127.0.0.1:12346";function createClient(c){var a=zmq.socket("push");a.identity="client"+process.pid;a.connect(c);console.log("client connected!");setInterval(function(){var b=Math.floor(100*Math.random());console.log(a.identity+": pushing "+b);a.send(b)},100)}
function createWorker(c){var a=zmq.socket("pull");a.identity="worker"+process.pid;a.on("message",function(b){console.log(a.identity+": pulled "+b.toString())});a.connect(c,function(a){if(a)throw a;console.log("worker connected!")})}
function createStreamerDevice(c,a){var b=zmq.socket("pull"),d=zmq.socket("push");b.identity="sub"+process.pid;d.identity="pub"+process.pid;b.bind(c,function(a){console.log("bound",c)});b.on("message",function(){console.log("forwarder: sending downstream",arguments[0].toString());d.send(Array.prototype.slice.call(arguments))});d.bind(a,function(b){console.log("bound",a)})}createStreamerDevice(frontPort,backPort);createClient(frontPort);createWorker(backPort);